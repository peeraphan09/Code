<%- include('../_header'); -%>


<style>
  .profile-page {
    max-width: 600px;
    margin: 40px auto;
    padding: 25px;
    background: #f9f9f9;
    border-radius: 12px;
    box-shadow: 0 0 12px rgba(0,0,0,0.05);
    font-family: 'Segoe UI', sans-serif;
  }

  .profile-page h2 {
    text-align: center;
    margin-bottom: 25px;
    color: #333;
  }

  .profile-page .image-preview {
    text-align: center;
    margin-bottom: 20px;
  }

  .profile-page .profile-img {
    width: 180px;
    height: 180px;
    object-fit: cover;
    border-radius: 50%;
    border: 3px solid #ccc;
  }

  .profile-page form {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .profile-page label {
    font-weight: bold;
    color: #444;
    margin-bottom: 5px;
  }

  .profile-page input[type="text"],
  .profile-page input[type="email"],
  .profile-page input[type="file"] {
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 14px;
  }

  .profile-page button {
    padding: 12px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s;
  }

  .profile-page button:hover {
    background-color: #0056b3;
  }
</style>

<div class="profile-page">
  <h2>จัดการโปรไฟล์</h2>

  <div class="image-preview">
    <img src="<%= user.profile_image || '/images/default-profile.png' %>" class="profile-img">
  </div>

  <form action="/user/profile" method="POST" enctype="multipart/form-data">
    <input type="hidden" name="old_image" value="<%= user.profile_image %>">

    <div>
      <label>ชื่อ:</label>
      <input type="text" name="first_name" value="<%= user.first_name %>" required>
    </div>

    <div>
      <label>นามสกุล:</label>
      <input type="text" name="last_name" value="<%= user.last_name %>" required>
    </div>

    <div>
      <label>เบอร์โทรศัพท์:</label>
      <input type="text" name="phone" value="<%= user.phone || '' %>">
    </div>

    <div>
      <label>อีเมล:</label>
      <input type="email" name="email" value="<%= user.email || '' %>">
    </div>

    <div>
      <label>รูปโปรไฟล์ใหม่:</label>
      <input type="file" name="profile_image">
    </div>

    <button type="submit">บันทึกการเปลี่ยนแปลง</button>
  </form>
</div>

<%- include('../_footer'); -%>
<% if (typeof successMessage !== 'undefined' && successMessage) { %>
  <div id="flash-message" data-message="<%- successMessage.replace(/"/g, '&quot;') %>"></div>
<% } %>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  const flashDiv = document.getElementById('flash-message');
  if (flashDiv) {
    const message = flashDiv.getAttribute('data-message');
    if (message) {
      Swal.fire({
        icon: 'success',
        title: 'สำเร็จ',
        text: message,
        confirmButtonText: 'ตกลง'
      });
    }
  }
</script>





